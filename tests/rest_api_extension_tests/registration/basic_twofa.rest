@base_url = https://localhost:8000
@username = annie.guilmeau@gmail.com
@current_password = Pass1234!

# @name post_signup
POST {{base_url}}/registration/signup/
Content-Type: application/json

{
    "username": "{{username}}",
    "password": "{{current_password}}"
}

###


# @name post_login
POST {{base_url}}/registration/login/
Content-Type: application/json

{
    "username": "{{username}}",
    "password": "{{current_password}}"
}

###

@ACCESS_COOKIE = {{post_login.response.headers.Set-Cookie}};



POST {{base_url}}/registration/otp_send_email/
Content-Type: application/json
Cookie: {{ACCESS_COOKIE}}

{"action": "twofa_enable"}

###

POST {{base_url}}/registration/otp_confirm_twofa/
Content-Type: application/json
Cookie: {{ACCESS_COOKIE}}

{
    "action": "twofa_enable",
    "otp": "GQQYN0QKZIU5R62L"
}

###


POST {{base_url}}/registration/login/
Content-Type: application/json

{
    "username": "{{username}}",
    "password": "{{current_password}}"
}

###

POST {{base_url}}/registration/otp_confirm_login/
Content-Type: application/json

{
    "username": "{{username}}",
    "otp": "xxxxxxxxxxxxxx"
}

###


POST {{base_url}}/registration/delete_user/
Content-Type: application/json
Cookie: {{ACCESS_COOKIE}} 

{"password": "{{current_password}}"}

###